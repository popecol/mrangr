<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How to use mrangr? • mrangr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How to use mrangr?">
<meta property="og:description" content="mrangr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mrangr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/mrangr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How to use mrangr?</h1>
                        <h4 data-toc-skip class="author">Author1</h4>
            
            <h4 data-toc-skip class="date">12-02-2026</h4>
      
      
      <div class="hidden name"><code>mrangr.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="about-mrangr">About <code>mrangr</code><a class="anchor" aria-label="anchor" href="#about-mrangr"></a>
</h2>
<p>This vignette demonstrates the main workflow of the
<code>mrangr</code> package, which is designed to simulate
metacommunities within a <strong>spatially explicit, mechanistic
framework</strong>. The package builds upon the functionality of the
<code>rangr</code> package, which focused on simulating single-species
population dynamics with dispersal.</p>
<p><code>mrangr</code> extends this by adding the ability to include
<strong>multiple interacting species</strong> via an <strong>asymmetric
interaction matrix</strong>, allowing for the flexible modelling of any
type of biotic interaction.</p>
</div>
<div class="section level2">
<h2 id="basic-workflow">Basic workflow<a class="anchor" aria-label="anchor" href="#basic-workflow"></a>
</h2>
<p>This vignette shows how to:</p>
<ol style="list-style-type: decimal">
<li><p>Create a virtual community.</p></li>
<li><p>Run a simulation.</p></li>
<li><p>Visualise results.</p></li>
<li><p>Collect virtual ecologist data.</p></li>
</ol>
<div class="section level3">
<h3 id="installing-the-package">Installing the package<a class="anchor" aria-label="anchor" href="#installing-the-package"></a>
</h3>
<p>The first step is to install and load the <code>mrangr</code>
package.</p>
<p>You can install <code>mrangr</code> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mrangr</span><span class="op">)</span></span></code></pre></div>
<p>or using the “Install” button in “Build” tab in RStudio.</p>
<p>Since the maps on which the simulation takes place must be in the
<code>SpatRaster</code> format, we will also install and load the
<code>terra</code> package to make them easier to manipulate and
visualise.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"terra"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="input-maps">Input maps<a class="anchor" aria-label="anchor" href="#input-maps"></a>
</h3>
<p>One of the required inputs is a set of maps that specify the
abundance of each virtual species at the start of the simulation
(<code>n1_map</code>), as well as carrying capacity maps for all species
in the community (<code>K_map</code>). We have provided some examples of
these in <code>mrangr</code>. You can find more information about these
datasets in the help files:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">?</span><span class="va">K_map_eg.tif</span></span>
<span><span class="op">?</span><span class="va">n1_map_eg.tif</span></span></code></pre></div>
<p>Now, let’s load and plot these maps.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Carrying capacity</span></span>
<span><span class="va">K_map_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"input_maps/K_map_eg.tif"</span>, package <span class="op">=</span> <span class="st">"mrangr"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">K_map_eg</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"K_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">K_map_eg</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="mrangr_files/figure-html/eg_maps_plot-1.png" width="480"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Initial abundance</span></span>
<span><span class="va">n1_map_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"input_maps/n1_map_eg.tif"</span>, package <span class="op">=</span> <span class="st">"mrangr"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">n1_map_eg</span> ,main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"n1_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">n1_map_eg</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="mrangr_files/figure-html/eg_maps_plot-2.png" width="480"></p>
<p>Both of these rasters have <strong>four</strong> layers. This means
that they are ready for simulations involving <strong>four</strong>
species, with each layer representing either the carrying capacity or
the initial abundance of a species. <strong>The order of the layers is
crucial</strong> and must be consistent across all simulation parameters
(e.g., species 1 corresponds to the first layer in the input maps, the
first row and column in the interaction matrix, and so on).</p>
<p>To begin, the <strong>input maps</strong> are generated using the
<code>K_sim</code> function, which creates spatially autocorrelated
rasters (e.g., representing carrying capacity). Subsequent steps require
the user to specify the <strong>number of species</strong> and supply a
<strong>template raster</strong> to define the simulation’s spatial
extent and resolution.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define species number</span></span>
<span><span class="va">nspec</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="co"># define map dimensions</span></span>
<span><span class="va">nrows</span> <span class="op">&lt;-</span> <span class="va">ncols</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span></span>
<span><span class="co"># prepare template raster</span></span>
<span><span class="va">xmin</span> <span class="op">&lt;-</span> <span class="fl">250000</span>; <span class="va">xmax</span> <span class="op">&lt;-</span> <span class="va">xmin</span> <span class="op">+</span> <span class="va">nrows</span> <span class="op">*</span> <span class="fl">1000</span></span>
<span><span class="va">ymin</span> <span class="op">&lt;-</span> <span class="fl">600000</span>; <span class="va">ymax</span> <span class="op">&lt;-</span> <span class="va">ymin</span> <span class="op">+</span> <span class="va">ncols</span> <span class="op">*</span> <span class="fl">1000</span></span>
<span><span class="va">id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/terra/man/rast.html" class="external-link">rast</a></span><span class="op">(</span>nrows <span class="op">=</span> <span class="va">nrows</span>, ncols <span class="op">=</span> <span class="va">ncols</span>, xmin <span class="op">=</span> <span class="va">xmin</span>, xmax <span class="op">=</span> <span class="va">xmax</span>, ymin <span class="op">=</span> <span class="va">ymin</span>, ymax <span class="op">=</span> <span class="va">ymax</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/crs.html" class="external-link">crs</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"epsg:2180"</span></span>
<span><span class="va">id</span></span>
<span></span>
<span><span class="co"># generate autocorrelated carrying capacity maps</span></span>
<span><span class="va">K_map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/K_sim.html">K_sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nspec</span>, <span class="va">id</span>, range <span class="op">=</span> <span class="fl">5e5</span>, qfun <span class="op">=</span> <span class="va">qlnorm</span>, meanlog <span class="op">=</span> <span class="fl">2</span>, sdlog <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>We generated a raster with two layers. Each layer represents the
carrying capacity map for a given virtual species. In this example, the
carrying capacity maps were generated using a log-normal distribution;
however, any distribution can be used by specifying the appropriate
quantile function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">K_map</span>, main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"K_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">K_map</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="mrangr_files/figure-html/K_sim_basic_plot-1.png" width="480"></p>
</div>
<div class="section level3">
<h3 id="species-interactions">Species interactions<a class="anchor" aria-label="anchor" href="#species-interactions"></a>
</h3>
<p>The next step is to define the interspecific interactions, which in
<code>mrangr</code> is done using an <strong>interaction
matrix</strong>. Each row and column of the matrix represents a virtual
species. Since we are using two species in our example, the matrix is
2×2. The values within the matrix represent the
<strong><em>per-capita</em></strong> <strong>interaction
strength</strong> of the species in the <strong>column</strong> on the
species in the <strong>row</strong>. This interaction is ultimately
realised as a change in the carrying capacity.</p>
<p>Here, we define a <strong>symmetric competitive</strong> interaction
between two species:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="op">-</span><span class="fl">0.8</span>, <span class="op">-</span><span class="fl">0.8</span>, <span class="cn">NA</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nspec</span>, ncol <span class="op">=</span> <span class="va">nspec</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2]</span></span>
<span><span class="co">#&gt; [1,]   NA -0.8</span></span>
<span><span class="co">#&gt; [2,] -0.8   NA</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="community-initialisation">Community initialisation<a class="anchor" aria-label="anchor" href="#community-initialisation"></a>
</h3>
<p>Now that we have defined the carrying capacity maps and interactions,
we can use the <code>initialize_com</code> function to create the
community. This function returns an object of the class
<code>sim_com_data</code>, which contains all the necessary data for
running a community simulation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_com</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/initialise_com.html">initialise_com</a></span><span class="op">(</span></span>
<span>  n1_map <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">K_map</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>  K_map <span class="op">=</span> <span class="va">K_map</span>, </span>
<span>  r <span class="op">=</span> <span class="fl">1.1</span>, </span>
<span>  a <span class="op">=</span> <span class="va">a</span>, </span>
<span>  rate <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<p>In the previous sections, we prepared <code>a</code> and
<code>K_map</code>, which we used to define our first metacommunity.
However, it was also necessary to pass several <strong>additional
arguments</strong>.</p>
<p>Here is a detailed breakdown of these:</p>
<ul>
<li>
<code>n1_map</code> is a <code>SpatRaster</code> object specifying
the <strong>initial abundance</strong> of species (in this example, set
to half of the carrying capacity).</li>
<li>The <code>r</code> parameter sets the population’s <strong>intrinsic
growth rate</strong>. You may provide a unique value for each species or
use a single value for all species, as in our case. The default
population growth function is the <strong>Gompertz
function</strong>.</li>
<li>The <code>rate</code> parameter is linked to the
<code>kernel_fun</code> parameter, which defaults to an exponential
function (<code>rexp</code>). Consequently, <code>rate</code> determines
the shape of the <strong>dispersal kernel</strong>, where the mean
dispersal distance is <em>1/rate</em>. It is essential that this
parameter is specified in the same units as the input maps. In our case,
these are <strong>metres</strong>.</li>
</ul>
<p>We can now use <code>summary</code> to take a closer look at the
<code>first_com</code> object.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">first_com</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of sim_com_data object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Input maps (K_map and n1_map) summary by species:</span></span>
<span><span class="co">#&gt;  species n1_min n1_mean n1_max K_min K_mean K_max</span></span>
<span><span class="co">#&gt;        1      1    4.20     16  2.05   8.40 32.19</span></span>
<span><span class="co">#&gt;        2      1    4.21     13  2.38   8.43 26.93</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Species-specific parameters:</span></span>
<span><span class="co">#&gt;  species   r r_sd K_sd A dens_dep kernel  kernel_args</span></span>
<span><span class="co">#&gt;        1 1.1    0    0 -      K2N "rexp" rate = 0.002</span></span>
<span><span class="co">#&gt;        2 1.1    0    0 -      K2N "rexp" rate = 0.002</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Interaction matrix (a):</span></span>
<span><span class="co">#&gt;      1    2</span></span>
<span><span class="co">#&gt; 1   NA -0.8</span></span>
<span><span class="co">#&gt; 2 -0.8   NA</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="running-the-simulation">Running the simulation<a class="anchor" aria-label="anchor" href="#running-the-simulation"></a>
</h3>
<p>All you need to run a simulation is a <code>sim_com_data</code>
object and the <strong>number of steps</strong> you wish to simulate.
Optionally, you can use the <strong><code>burn</code></strong> parameter
to discard the initial time steps, but we will omit it for this
example.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">first_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sim_com.html">sim_com</a></span><span class="op">(</span><span class="va">first_com</span>, time <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<p>Now, let’s examine the summary of the first simulation.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">first_sim</span><span class="op">)</span></span>
<span><span class="co">#&gt; Summary of sim_com_results object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Abundances summary: </span></span>
<span><span class="co">#&gt;   species min q1 median mean q3 max</span></span>
<span><span class="co">#&gt; 1       1   0  0      3 5.20  9  45</span></span>
<span><span class="co">#&gt; 2       2   0  0      3 5.16  9  41</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulated time steps:  100 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Extinction: </span></span>
<span><span class="co">#&gt;     1     2 </span></span>
<span><span class="co">#&gt; FALSE FALSE</span></span></code></pre></div>
<p>The summary reveals the following key information:</p>
<ul>
<li>The function <code>sim_com</code> returns an object of class
<code>sim_com_results</code>.</li>
<li>The mean abundance across species is relatively similar.</li>
<li>The simulation was executed for 100 time steps.</li>
<li>None of the species experienced extinction during the
simulation.</li>
</ul>
</div>
<div class="section level3">
<h3 id="visualisation">Visualisation<a class="anchor" aria-label="anchor" href="#visualisation"></a>
</h3>
<div class="section level4">
<h4 id="over-space">Over space<a class="anchor" aria-label="anchor" href="#over-space"></a>
</h4>
<p>To take a closer look at the final step of the simulation, we will
use the <code><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot()</a></code> function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">first_sim</span>, time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="mrangr_files/figure-html/maps-1.png" width="480"></p>
<p>The initial spatial distribution was set to be proportional to the
carrying capacity of each species’ habitat, effectively representing
their <strong>fundamental niches</strong>. Following the simulation,
<strong>competitive exclusion</strong> drove the species’ ranges to
become almost entirely separate. The resulting distribution maps
illustrate the species’ final <strong>realised niches</strong>.</p>
</div>
<div class="section level4">
<h4 id="over-time">Over time<a class="anchor" aria-label="anchor" href="#over-time"></a>
</h4>
<p>We can also use the <code><a href="../reference/plot_series.html">plot_series()</a></code> function to plot the
mean species abundances over all time steps.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_series.html">plot_series</a></span><span class="op">(</span><span class="va">first_sim</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, title <span class="op">=</span> <span class="st">"Species"</span>, legend <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nspec</span>, </span>
<span>       lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nspec</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">nspec</span><span class="op">)</span></span></code></pre></div>
<p><img src="mrangr_files/figure-html/time_series-1.png" width="480"></p>
</div>
</div>
<div class="section level3">
<h3 id="virtual-ecologist">Virtual ecologist<a class="anchor" aria-label="anchor" href="#virtual-ecologist"></a>
</h3>
<p>The final component in this basic workflow is the
<code><a href="../reference/virtual_ecologist.html">virtual_ecologist()</a></code> function. It serves to simulate the
real-world observation process, allowing the user to sample the
simulated community abundances at defined points in space and time. This
step is crucial for incorporating the effects of sampling effort and
detection probability into the analysis.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ve</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/virtual_ecologist.html">virtual_ecologist</a></span><span class="op">(</span></span>
<span>  <span class="va">first_sim</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"random_one_layer"</span>,</span>
<span>  prop <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ve</span><span class="op">)</span></span>
<span><span class="co">#&gt;     id      x      y species time n</span></span>
<span><span class="co">#&gt; 1 6323 272500 636500       1    1 4</span></span>
<span><span class="co">#&gt; 2 1363 312500 686500       1    1 2</span></span>
<span><span class="co">#&gt; 3 5253 302500 647500       1    1 5</span></span>
<span><span class="co">#&gt; 4 3214 263500 667500       1    1 4</span></span>
<span><span class="co">#&gt; 5 1079 328500 689500       1    1 2</span></span>
<span><span class="co">#&gt; 6 2268 317500 677500       1    1 2</span></span></code></pre></div>
<p>For this demonstration, we used the sampling strategy
<code>type = "random_one_layer"</code>, meaning a random set of cells is
sampled in each time step. The <code>prop</code> argument controls the
proportion of cells sampled. Let’s inspect the structure of the
resulting <code>data.frame</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/headtail.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ve</span><span class="op">)</span></span>
<span><span class="co">#&gt;     id      x      y species time n</span></span>
<span><span class="co">#&gt; 1 6323 272500 636500       1    1 4</span></span>
<span><span class="co">#&gt; 2 1363 312500 686500       1    1 2</span></span>
<span><span class="co">#&gt; 3 5253 302500 647500       1    1 5</span></span>
<span><span class="co">#&gt; 4 3214 263500 667500       1    1 4</span></span>
<span><span class="co">#&gt; 5 1079 328500 689500       1    1 2</span></span>
<span><span class="co">#&gt; 6 2268 317500 677500       1    1 2</span></span></code></pre></div>
<p>The output <code>data.frame</code> includes the following six
columns:</p>
<ul>
<li>
<code>id</code>: Unique cell identifier.</li>
<li>
<code>x</code>, <code>y</code>: Sampled cell coordinates.</li>
<li>
<code>species</code>: Species number or name.</li>
<li>
<code>time</code>: Sampled time step.</li>
<li>
<code>n</code>: Sampled abundance.</li>
</ul>
<p>An alternative usage of <code><a href="../reference/virtual_ecologist.html">virtual_ecologist()</a></code> is to supply
a <code>data.frame</code> that pre-defines the sampling design,
containing the columns <code>"x"</code>, <code>"y"</code>, and
<code>"time"</code>. This specifies the spatial and temporal points of
interest for observation.</p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>In this vignette, we demonstrated the key functionalities of the
<code>mrangr</code> package, specifically how to:</p>
<ul>
<li>Initialize a multi-species community using the
<code><a href="../reference/initialise_com.html">initialise_com()</a></code> function.</li>
<li>Run spatially explicit simulations with <code><a href="../reference/sim_com.html">sim_com()</a></code>.</li>
<li>Visualize outputs using <code><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot()</a></code> and track abundance
changes over time with <code><a href="../reference/plot_series.html">plot_series()</a></code>.</li>
<li>Generate simulated observation data (sampling) via the
<code><a href="../reference/virtual_ecologist.html">virtual_ecologist()</a></code> function.</li>
</ul>
<p>Collectively, these tools establish <code>mrangr</code> as a powerful
framework for <strong>mechanistic, spatially explicit metacommunity
simulation</strong>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Author1name Author1surname, Author2name Author2surname.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
